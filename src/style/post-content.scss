// 前台文章内容展示样式
// 包含基础样式 + 前台特定的增强效果（如懒加载）

@use "./article-content-base.scss" as *;

// 懒加载相关动画
@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

@keyframes lazy-loading-spinner {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes fadeInImage {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.post-content {
  line-height: 1.8;
  word-wrap: break-word;
  overflow-wrap: break-word;

  // 应用所有文章内容基础样式
  @include article-content-base;

  // Performance: browser-level "virtual rendering" for very long articles.
  // Skips layout/paint for offscreen blocks in supported browsers (Chrome/Edge).
  @supports (content-visibility: auto) {
    > * {
      content-visibility: auto;
      // Reserve a reasonable placeholder height to reduce layout jumps.
      // (width height) — width is irrelevant for block layout, keep it tiny.
      contain-intrinsic-size: 1px 800px;
    }
  }

  // 修复：tip插件需要覆盖content-visibility: auto，避免绝对定位的tooltip无法显示
  .anzhiyu-tip-wrapper {
    content-visibility: visible;
  }

  // 前台特有：图片缩放效果
  img:not(a img) {
    cursor: zoom-in;
  }

  // 前台特有：懒加载图片样式
  .lazy-image {
    background-color: var(--anzhiyu-secondbg);

    &.lazy-loading {
      position: relative;
      opacity: 0.6;
    }

    &.lazy-loaded {
      background: transparent;
      animation: fadeInImage 0.3s ease-out;
    }

    &.lazy-error {
      position: relative;
      background-color: var(--anzhiyu-secondbg);
      animation: none;

      &::before {
        content: "图片加载失败";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: var(--anzhiyu-fontcolor);
        font-size: 12px;
        opacity: 0.6;
        white-space: nowrap;
      }
    }
  }
}
